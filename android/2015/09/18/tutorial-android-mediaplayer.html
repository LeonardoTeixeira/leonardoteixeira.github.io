<!DOCTYPE html><html lang="pt-br"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Tutorial: Trabalhando com o MediaPlayer do Android</title><meta name="description" content="Aprenda neste tutorial a usar o recurso MediaPlayer do Android. Veja como construir um pequeno aplicativo para reprodução de áudio."><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"><link rel="canonical" href="http://localhost:4000/android/2015/09/18/tutorial-android-mediaplayer.html"><link rel="alternate" type="application/rss+xml" title="Blog do Leonardo Teixeira" href="feed.xml"><link rel="publisher" href="https://plus.google.com/111411156907213922073"><meta property="og:locale" content="pt_BR"><meta property="og:type" content="article"><meta property="og:title" content="Tutorial: Trabalhando com o MediaPlayer do Android"><meta property="og:description" content="Aprenda neste tutorial a usar o recurso MediaPlayer do Android. Veja como construir um pequeno aplicativo para reprodução de áudio."><meta property="og:url" content="http://localhost:4000/android/2015/09/18/tutorial-android-mediaplayer.html"><meta property="og:site_name" content="Blog do Leonardo Teixeira"><meta property="article:publisher" content="https://www.facebook.com/leonardocteixeira"><style>.icon>svg,img{vertical-align:middle}body,figure,h1,h2,h3,p,pre,ul{margin:0;padding:0}body{font:400 16px/1.5 "Helvetica Neue",Helvetica,Arial,sans-serif;color:#111;background-color:#fdfdfd;-webkit-text-size-adjust:100%;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1;font-feature-settings:"kern" 1;font-kerning:normal}.highlight,figure,h1,h2,h3,p,pre,ul{margin-bottom:15px}img{max-width:100%}ul{margin-left:30px}h1,h2,h3{font-weight:400}a{color:#2a7ae2;text-decoration:none}a:visited{color:#1756a9}a:hover{color:#111;text-decoration:underline}code,pre{font-size:15px;border:1px solid #e8e8e8;border-radius:3px;background-color:#eef}code{padding:1px 5px}pre{padding:8px 12px;overflow-x:auto}pre>code{border:0;padding-right:0;padding-left:0}.wrapper{max-width:-webkit-calc(800px - (30px * 2));max-width:calc(800px - (30px * 2));margin-right:auto;margin-left:auto;padding-right:30px;padding-left:30px}@media screen and (max-width:800px){.wrapper{max-width:-webkit-calc(800px - (30px));max-width:calc(800px - (30px));padding-right:15px;padding-left:15px}}.footer-col-wrapper:after,.wrapper:after{content:"";display:table;clear:both}.icon>svg{display:inline-block;width:16px;height:16px}.icon>svg path{fill:#828282}.site-header{border-top:5px solid #424242;border-bottom:1px solid #e8e8e8;min-height:56px;position:relative}.site-title{font-size:26px;font-weight:300;line-height:56px;letter-spacing:-1px;margin-bottom:0;float:left}.highlight .k,.highlight .kc,.highlight .kd,.highlight .kt,.highlight .nc,.highlight .nf,.highlight .o{font-weight:700}.site-title,.site-title:visited{color:#424242}.site-nav{float:right;line-height:56px}.site-nav .menu-icon{display:none}.site-nav .page-link{color:#111;line-height:1.5}.site-nav .page-link:not(:last-child){margin-right:20px}@media screen and (max-width:600px){.site-nav{position:absolute;top:9px;right:15px;background-color:#fdfdfd;border:1px solid #e8e8e8;border-radius:5px;text-align:right}.site-nav .menu-icon{display:block;float:right;width:36px;height:26px;line-height:0;padding-top:10px;text-align:center}.site-nav .menu-icon>svg{width:18px;height:15px}.site-nav .menu-icon>svg path{fill:#424242}.site-nav .trigger{clear:both;display:none}.site-nav:hover .trigger{display:block;padding-bottom:5px}.site-nav .page-link{display:block;padding:5px 10px;margin-left:20px}.site-nav .page-link:not(:last-child){margin-right:0}}.site-footer{border-top:1px solid #e8e8e8;padding:30px 0}.footer-heading{font-size:18px;margin-bottom:15px}.contact-list,.social-media-list{list-style:none;margin-left:0}.footer-col-wrapper{font-size:15px;color:#828282;margin-left:-15px}.footer-col{float:left;margin-bottom:15px;padding-left:15px}.post-content,.post-header,.post-list>li{margin-bottom:30px}.footer-col-1{width:-webkit-calc(35% - (30px / 2));width:calc(35% - (30px / 2))}.footer-col-2{width:-webkit-calc(20% - (30px / 2));width:calc(20% - (30px / 2))}.footer-col-3{width:-webkit-calc(45% - (30px / 2));width:calc(45% - (30px / 2))}@media screen and (max-width:800px){.footer-col-1,.footer-col-2{width:-webkit-calc(50% - (30px / 2));width:calc(50% - (30px / 2))}.footer-col-3{width:-webkit-calc(100% - (30px / 2));width:calc(100% - (30px / 2))}}@media screen and (max-width:600px){.footer-col{float:none;width:-webkit-calc(100% - (30px / 2));width:calc(100% - (30px / 2))}}.page-content{padding:30px 0}.page-heading{font-size:20px}.post-list{margin-left:0;list-style:none}.post-meta{font-size:14px;color:#828282}.post-link{display:block;font-size:24px}.post-title{font-size:42px;letter-spacing:-1px;line-height:1}@media screen and (max-width:800px){.post-title{font-size:36px}}.post-content h2{font-size:32px}@media screen and (max-width:800px){.post-content h2{font-size:28px}}.post-content h3{font-size:26px}@media screen and (max-width:800px){.post-content h3{font-size:22px}}.highlight{background:#fff}.highlight .kt{color:#458}.highlight .s{color:#d14}.highlight .na{color:teal}.highlight .nc{color:#458}.highlight .nf{color:#900}.highlight .nt{color:navy}</style><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-54292630-2","auto"),ga("send","pageview");</script></head><body><header class="site-header"><div class="wrapper"><a class="site-title" href="/">Blog do Leonardo Teixeira</a><nav class="site-nav"><a href="#" class="menu-icon"><svg viewBox="0 0 18 15"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/></svg></a><div class="trigger"><a class="page-link" href="/projetos/">Projetos</a> <a class="page-link" href="/leonardo-teixeira/">Sobre o Leonardo</a> <a class="page-link" href="/contato/">Contato</a></div></nav></div></header><div class="page-content"><div class="wrapper"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header class="post-header"><h1 class="post-title" itemprop="name headline">Tutorial: Trabalhando com o MediaPlayer do Android</h1><p class="post-meta"><time datetime="2015-09-18T14:47:35-03:00" itemprop="datePublished">Sep 18, 2015</time></p></header><div class="post-content" itemprop="articleBody"><p>Neste tutorial você irá aprender a trabalhar com o <a href="http://developer.android.com/reference/android/media/MediaPlayer.html">MediaPlayer</a> do <strong>Android</strong> para executar arquivos de áudio.</p><p>Iremos construir um simples aplicativo para reproduzir sons de animais. A ideia é que ao clicar no nome de um determinado animal o som característico dele seja reproduzido.</p><p>Ao terminarmos o aplicativo ele ficará com esta aparência:</p><p><img src="/img/posts/android-mediaplayer/tutorial-android-mediaplayer.gif" alt="Tutorial Android MediaPlayer"></p><h2 id="criando-o-projeto-no-android-studio">Criando o projeto no Android Studio</h2><p>Antes de mais nada vamos criar o nosso projeto no Android Studio.</p><p>Abra o seu Android Studio e clique em “Start a new Android Studio project”.</p><p><img src="/img/posts/android-mediaplayer/criar-novo-projeto-android-studio.jpg" alt="Criar um novo projeto no Android Studio"></p><p>Escolha um nome para o seu projeto. Eu escolhi o nome “Tutorial MediaPlayer”.</p><p><img src="/img/posts/android-mediaplayer/configurar-novo-projeto.jpg" alt="Configurar projeto no Android Studio"></p><p>Agora vamos definir a versão mínima para o qual o nosso projeto pretende dar suporte. Eu defini a API 9 (Android 2.3 – Gingerbread).</p><p><img src="/img/posts/android-mediaplayer/target-projeto-android-studio.jpg?resize=600%2C386" alt="Definir a API de suporte mínima no Android Studio"></p><p>Agora vamos criar uma activity para o nosso projeto. Escolha uma “Blank Activity”.</p><p><img src="/img/posts/android-mediaplayer/criar-activity-android-studio.jpg" alt="Criar nova activity no Android Studio"></p><p>Na próxima tela mantenha o nome padrão da activty, no caso “MainActivity”.</p><p><img src="/img/posts/android-mediaplayer/nomeando-activity-android-studio.jpg" alt="Nomeando activity no Android Studio"></p><p>Pronto, o nosso projeto está criado!</p><h2 id="criando-a-interface-de-usuário">Criando a interface de usuário</h2><p>Agora que o nosso projeto já está criado, vamos criar a nossa interface de usuário.</p><p>Antes de mais nada, vamos definir os textos das strings que iremos utilizar em nossa interface. Para isso abra o arquivo <code class="highlighter-rouge">strings.xml</code> localizado na pasta <code class="highlighter-rouge">res/xml</code> e adicione as seguintes linhas:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"animal_dog"</span><span class="nt">&gt;</span>Cachorro<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"animal_cat"</span><span class="nt">&gt;</span>Gato<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"animal_horse"</span><span class="nt">&gt;</span>Cavalo<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"animal_cow"</span><span class="nt">&gt;</span>Vaca<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"animal_pig"</span><span class="nt">&gt;</span>Porco<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"animal_rooster"</span><span class="nt">&gt;</span>Galo<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"animal_lion"</span><span class="nt">&gt;</span>Leão<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"animal_turkey"</span><span class="nt">&gt;</span>Peru<span class="nt">&lt;/string&gt;</span></code></pre></figure><p>Agora abra o arquivo <code class="highlighter-rouge">activity_main.xml</code>, localizado na pasta <code class="highlighter-rouge">res/layout</code>.</p><p>Iremos utilizar um layout do tipo <strong>LinearLayout</strong> com a orientação vertical. Desta forma, cada elemento que for adicionado (neste caso, botões) será posicionado logo abaixo do anterior.</p><p>Vamos adicionar 8 botões, um para cada animal.</p><p>Nosso arquivo <code class="highlighter-rouge">activity_main.xml</code> ficará assim:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
    <span class="na">xmlns:tools=</span><span class="s">"http://schemas.android.com/tools"</span> <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
    <span class="na">android:layout_height=</span><span class="s">"match_parent"</span> <span class="na">android:paddingLeft=</span><span class="s">"@dimen/activity_horizontal_margin"</span>
    <span class="na">android:paddingRight=</span><span class="s">"@dimen/activity_horizontal_margin"</span>
    <span class="na">android:paddingTop=</span><span class="s">"@dimen/activity_vertical_margin"</span>
    <span class="na">android:paddingBottom=</span><span class="s">"@dimen/activity_vertical_margin"</span> <span class="na">tools:context=</span><span class="s">".MainActivity"</span>
    <span class="na">android:orientation=</span><span class="s">"vertical"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:text=</span><span class="s">"@string/animal_dog"</span>
        <span class="na">android:id=</span><span class="s">"@+id/btnDog"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:text=</span><span class="s">"@string/animal_cat"</span>
        <span class="na">android:id=</span><span class="s">"@+id/btnCat"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:text=</span><span class="s">"@string/animal_horse"</span>
        <span class="na">android:id=</span><span class="s">"@+id/btnHorse"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:text=</span><span class="s">"@string/animal_cow"</span>
        <span class="na">android:id=</span><span class="s">"@+id/btnCow"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:text=</span><span class="s">"@string/animal_pig"</span>
        <span class="na">android:id=</span><span class="s">"@+id/btnPig"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:text=</span><span class="s">"@string/animal_rooster"</span>
        <span class="na">android:id=</span><span class="s">"@+id/btnRooster"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:text=</span><span class="s">"@string/animal_lion"</span>
        <span class="na">android:id=</span><span class="s">"@+id/btnLion"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:text=</span><span class="s">"@string/animal_turkey"</span>
        <span class="na">android:id=</span><span class="s">"@+id/btnTurkey"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span></code></pre></figure><h2 id="adicionado-os-arquivos-de-áudio">Adicionado os arquivos de áudio</h2><p>Agora vamos adicionar os 8 arquivos de áudio, cada um com o som de um animal. Os arquivos estão em formato WAV e foram pegos na internet, a maioria do site <a href="http://soundbible.com/">http://soundbible.com/</a>.</p><p>Crie uma pasta chamada raw dentro da pasta <code class="highlighter-rouge">res</code>. É nesta pasta que iremos armazenar os arquivos de áudio.</p><p>Os arquivos de áudio estão disponíveis <a href="https://github.com/LeonardoTeixeira/tutorial-android-mediaplayer/tree/master/app/src/main/res/raw">neste link</a>, baixe um por um e adicione na pasta <code class="highlighter-rouge">res/raw</code> do seu projeto.</p><p><img src="/img/posts/android-mediaplayer/arquivos-de-audio.jpg" alt="Arquivos de Áudio"></p><h2 id="trabalhando-com-o-mediaplayer">Trabalhando com o MediaPlayer</h2><p>Agora que já criamos a nossa interface do usuário e adicionamos os arquivos de áudio necessários para nossa aplicação, vamos finalmente trabalhar com o <strong>MediaPlayer</strong> em nossa activity principal.</p><p>Abra o arquivo <code class="highlighter-rouge">MainActivity</code> e defina uma variável do tipo Button para cada botão:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="n">Button</span> <span class="n">btnDog</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">Button</span> <span class="n">btnCat</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">Button</span> <span class="n">btnHorse</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">Button</span> <span class="n">btnCow</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">Button</span> <span class="n">btnPig</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">Button</span> <span class="n">btnRooster</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">Button</span> <span class="n">btnLion</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">Button</span> <span class="n">btnTurkey</span><span class="o">;</span></code></pre></figure><p>Crie também uma variável to tipo <strong>MediaPlayer</strong>:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="n">MediaPlayer</span> <span class="n">mp</span><span class="o">;</span></code></pre></figure><p>Agora vamos implementar a interface <code class="highlighter-rouge">View.OnClickListener</code> para podermos capturar os eventos de clique nos botões.</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">AppCompatActivity</span> <span class="kd">implements</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span> <span class="o">{</span></code></pre></figure><p>Agora no nosso método <em>onCreate</em> iremos instanciar as variáveis <em>mp</em> e dos botões e setar o listener do evento <em>OnClick</em>.</p><p>Nosso método onCreate ficará assim:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
    <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>

    <span class="n">mp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MediaPlayer</span><span class="o">();</span>
    <span class="n">mp</span><span class="o">.</span><span class="na">setOnPreparedListener</span><span class="o">(</span><span class="k">new</span> <span class="n">MediaPlayer</span><span class="o">.</span><span class="na">OnPreparedListener</span><span class="o">()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onPrepared</span><span class="o">(</span><span class="n">MediaPlayer</span> <span class="n">mp</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">mp</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">});</span>

    <span class="n">btnDog</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnDog</span><span class="o">);</span>
    <span class="n">btnCat</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnCat</span><span class="o">);</span>
    <span class="n">btnHorse</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnHorse</span><span class="o">);</span>
    <span class="n">btnCow</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnCow</span><span class="o">);</span>
    <span class="n">btnPig</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnPig</span><span class="o">);</span>
    <span class="n">btnRooster</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnRooster</span><span class="o">);</span>
    <span class="n">btnLion</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnLion</span><span class="o">);</span>
    <span class="n">btnTurkey</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnTurkey</span><span class="o">);</span>

    <span class="n">btnDog</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="n">btnCat</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="n">btnHorse</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="n">btnCow</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="n">btnPig</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="n">btnRooster</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="n">btnLion</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="n">btnTurkey</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>No método <em>onClick</em> , que é disparado quando cada um dos botões forem clicados, iremos verificar qual dos botões foi clicado e setar o áudio referente a este botão. Para isso usamos o método <em>setDataSource</em> da classe <code class="highlighter-rouge">MediaPlayer</code>.</p><p>Antes disso iremos verificar se o player já não está tocando, ou seja, se algum botão já não foi clicado e o áudio ainda está rodando. Se ele estiver tocando iremos pará-lo antes de executá-lo novamente. Para isso, usamos o método <em>isPlaying</em> para saber se o player está tocando e o método <em>stop</em> para pará-lo.</p><p>Nosso método onClick ficará assim:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">mp</span><span class="o">.</span><span class="na">isPlaying</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">mp</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
        <span class="n">AssetFileDescriptor</span> <span class="n">afd</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">getId</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">case</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnDog</span><span class="o">:</span>
                <span class="n">afd</span> <span class="o">=</span> <span class="n">getResources</span><span class="o">().</span><span class="na">openRawResourceFd</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">raw</span><span class="o">.</span><span class="na">dog</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnCat</span><span class="o">:</span>
                <span class="n">afd</span> <span class="o">=</span> <span class="n">getResources</span><span class="o">().</span><span class="na">openRawResourceFd</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">raw</span><span class="o">.</span><span class="na">cat</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnHorse</span><span class="o">:</span>
                <span class="n">afd</span> <span class="o">=</span> <span class="n">getResources</span><span class="o">().</span><span class="na">openRawResourceFd</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">raw</span><span class="o">.</span><span class="na">horse</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnCow</span><span class="o">:</span>
                <span class="n">afd</span> <span class="o">=</span> <span class="n">getResources</span><span class="o">().</span><span class="na">openRawResourceFd</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">raw</span><span class="o">.</span><span class="na">cow</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnPig</span><span class="o">:</span>
                <span class="n">afd</span> <span class="o">=</span> <span class="n">getResources</span><span class="o">().</span><span class="na">openRawResourceFd</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">raw</span><span class="o">.</span><span class="na">pig</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnRooster</span><span class="o">:</span>
                <span class="n">afd</span> <span class="o">=</span> <span class="n">getResources</span><span class="o">().</span><span class="na">openRawResourceFd</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">raw</span><span class="o">.</span><span class="na">rooster</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnLion</span><span class="o">:</span>
                <span class="n">afd</span> <span class="o">=</span> <span class="n">getResources</span><span class="o">().</span><span class="na">openRawResourceFd</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">raw</span><span class="o">.</span><span class="na">lion</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnTurkey</span><span class="o">:</span>
                <span class="n">afd</span> <span class="o">=</span> <span class="n">getResources</span><span class="o">().</span><span class="na">openRawResourceFd</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">raw</span><span class="o">.</span><span class="na">turkey</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">afd</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">mp</span><span class="o">.</span><span class="na">setDataSource</span><span class="o">(</span><span class="n">afd</span><span class="o">.</span><span class="na">getFileDescriptor</span><span class="o">(),</span> <span class="n">afd</span><span class="o">.</span><span class="na">getStartOffset</span><span class="o">(),</span> <span class="n">afd</span><span class="o">.</span><span class="na">getLength</span><span class="o">());</span>
            <span class="n">mp</span><span class="o">.</span><span class="na">prepareAsync</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="s">""</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Para que não ocorra nenhum travamento durante a reprodução do áudio, iremos executar o player de forma assíncrona. Para fazermos isso usando o MediaPlayer é muito simples, chamamos o método <em>prepareAsync</em> e só executamos o método <em>play</em> (tocar) quando o método <em>setOnPreparedListener</em> for chamado.</p><p>Por fim, quando fecharmos o aplicativo, devemos verificar se o player está tocando e, caso esteja, devemos pará-lo. Para isso vamos sobrescrever o método <em>onStop</em> da activity e usar os métodos <em>isPlaying</em> e <em>stop</em>:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onStop</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onStop</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">mp</span><span class="o">.</span><span class="na">isPlaying</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">mp</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="n">mp</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure><p>O arquivo <code class="highlighter-rouge">MainActivity</code> completo pode ser <a href="https://github.com/LeonardoTeixeira/tutorial-android-mediaplayer/blob/master/app/src/main/java/br/com/leonardoteixeira/tutorialmediaplayer/MainActivity.java">visto aqui</a>.</p><p>O projeto completo pode ser visto e baixado no Github: <a href="https://github.com/LeonardoTeixeira/tutorial-android-mediaplayer">https://github.com/LeonardoTeixeira/tutorial-android-mediaplayer</a></p></div><div id="disqus_thread"></div><script>var disqus_config=function(){this.page.url="http://localhost:4000/android/2015/09/18/tutorial-android-mediaplayer.html",this.page.identifier="http://localhost:4000/android/2015/09/18/tutorial-android-mediaplayer.html"};!function(){var e=document,t=e.createElement("script");t.src="//blogleonardoteixeira.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}();</script></article></div></div><footer class="site-footer"><div class="wrapper"><h2 class="footer-heading">Blog do Leonardo Teixeira</h2><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li>Blog do Leonardo Teixeira</li><li><a href="mailto:blog@leonardoteixeira.com.br">blog@leonardoteixeira.com.br</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/LeonardoTeixeira"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg> </span><span class="username">LeonardoTeixeira</span></a></li></ul></div><div class="footer-col footer-col-3"><p>Artigos sobre desenvolvimento e programação PHP, Node.js, Java, Android, AWS e tecnologia em geral.</p></div></div></div></footer></body></html>